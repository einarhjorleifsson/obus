[{"path":"https://einarhjorleifsson.github.io/obus/articles/on_meanings.html","id":"datatype","dir":"Articles","previous_headings":"","what":"DataType","title":"On meanings","text":"variable DataType resides HH-table following: R: R (Recorded haul): catch sorted species might subsampled, subfactors >= 1 S: S (subsampled data): catch subsampled sorting, sub factors > 1 C: C (Data CPUE): catch calculated CPUE level, sub factors 1 P: NA: Questions: stay across single survey, across years DataType R: DataType S: DataType C: DataType P:","code":"hh |>    count(DataType) |>    mutate(p = round(n / sum(n, na.rm = TRUE) * 100, 1)) |>    arrange(DataType) #> # Source:     SQL [?? x 3] #> # Database:   DuckDB 1.4.3 [unknown@Linux 6.11.0-1018-azure:R 4.5.2/:memory:] #> # Ordered by: DataType #>   DataType     n     p #>   <chr>    <dbl> <dbl> #> 1 C        49173  33.4 #> 2 P         1683   1.1 #> 3 R        95144  64.7 #> 4 S          969   0.7 #> 5 NA          40   0"},{"path":"https://einarhjorleifsson.github.io/obus/articles/on_meanings.html","id":"totalno","dir":"Articles","previous_headings":"DataType","what":"TotalNo","title":"On meanings","text":"DataType R: total number fish one species, sex, category given haul. DataType S: total number fish one species, sex, category given haul. DataType C: total number fish one species sex given haul, raised 1 hour hauling. DataType P:","code":""},{"path":"https://einarhjorleifsson.github.io/obus/articles/on_meanings.html","id":"catidentifier---subsample-identifier","dir":"Articles","previous_headings":"DataType","what":"CatIdentifier - subsample identifier???","title":"On meanings","text":"DataType R: Category within species sex. field can used categorize fish different size weight categories. Different categories within one haul, species, sex, can different sub-factors. field reported 0, use 1 one category present. DataType S: DataType C: 1 DataType P:","code":""},{"path":"https://einarhjorleifsson.github.io/obus/articles/on_meanings.html","id":"nomeas","dir":"Articles","previous_headings":"DataType","what":"NoMeas","title":"On meanings","text":"DataType R: Number fish measured given haul sub-sample, species, sex DataType S: DataType C: DataType P:","code":""},{"path":"https://einarhjorleifsson.github.io/obus/articles/on_meanings.html","id":"subfactor","dir":"Articles","previous_headings":"DataType","what":"SubFactor","title":"On meanings","text":"DataType R: Sub-sampling factor haul, species, sex, length. Value = > 1. Make sure TotalNo = NoMeas x SubFactor. DataType S: Sub-sampling factor haul, species, sex, length. Value always > 1. Make sure TotalNo = NoMeas x SubFactor. DataType C: 1. DataType P:","code":""},{"path":"https://einarhjorleifsson.github.io/obus/articles/on_meanings.html","id":"subwgt","dir":"Articles","previous_headings":"DataType","what":"SubWgt","title":"On meanings","text":"DataType R: total weight sub-sampled fish reported NoMeas. DataType S: . DataType C: total weight sub-sampled fish reported NoMeas report -9. DataType P:","code":""},{"path":"https://einarhjorleifsson.github.io/obus/articles/on_meanings.html","id":"catcatchwgt","dir":"Articles","previous_headings":"DataType","what":"CatCatchWgt","title":"On meanings","text":"DataType R: Catch weight fish per species, sex, category given haul (TotalNo). DataType S: DataType C: Catch weight per species per haul, raised one hour hauling. DataType P:","code":""},{"path":"https://einarhjorleifsson.github.io/obus/articles/on_meanings.html","id":"hlnoatlngt","dir":"Articles","previous_headings":"DataType","what":"HLNoAtLngt","title":"On meanings","text":"DataType R: number fish sex species, category haul. Make sure TotalNo = Sum (HLNoAtLngt) x SubFactor NoMeas = Sum (HLNoAtLngt) DataType S: . DataType C: number fish sex species haul adjusted one hour catching. Make sure TotalNo = Sum (HLNoAtLngt). DataType P:","code":""},{"path":"https://einarhjorleifsson.github.io/obus/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Einar Hjorleifsson. Maintainer. Martin Pastoors. Author.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pastoors M (2025). obus: Implementing Better Use ICES Survey data. R package version 2025.12.24, https://einarhjorleifsson.github.io/obus/.","code":"@Manual{,   title = {obus: Implementing More and Better Use of ICES Survey data},   author = {Martin Pastoors},   year = {2025},   note = {R package version 2025.12.24},   url = {https://einarhjorleifsson.github.io/obus/}, }"},{"path":"https://einarhjorleifsson.github.io/obus/index.html","id":"obus","dir":"","previous_headings":"","what":"Implementing More and Better Use of ICES Survey data","title":"Implementing More and Better Use of ICES Survey data","text":"{obus} temporary experimental package used explore various DATRAS data connections wrapper functions make life little easier everyday user. may taken offical package.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Implementing More and Better Use of ICES Survey data","text":"can install development version imbus GitHub :","code":"# install.packages(\"pak\") #pak::pak(\"einarhjorleifsson/obus\")"},{"path":"https://einarhjorleifsson.github.io/obus/index.html","id":"table-connections","dir":"","previous_headings":"","what":"Table connections","title":"Implementing More and Better Use of ICES Survey data","text":"","code":"library(obus) hh <- dr_con(\"HH\") hl <- dr_con(\"HL\") ca <- dr_con(\"CA\")"},{"path":"https://einarhjorleifsson.github.io/obus/index.html","id":"a-little-peek","dir":"","previous_headings":"","what":"A little peek","title":"Implementing More and Better Use of ICES Survey data","text":"","code":"library(tidyverse) hl |> glimpse() #> Rows: ?? #> Columns: 24 #> Database: DuckDB 1.4.3 [unknown@Linux 5.10.0-33-amd64:R 4.4.1/:memory:] #> $ .id                  <chr> \"BITS:2008:4:DK:26HI:TVS:1874:23\", \"BITS:1997:4:S… #> $ SpecCodeType         <chr> \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\",… #> $ SpecCode             <chr> \"127143\", \"126425\", \"126425\", \"126425\", \"126425\",… #> $ SpecVal              <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\",… #> $ Sex                  <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… #> $ TotalNo              <dbl> 19.00, 1571.11, 1571.11, 1571.11, 1571.11, 10.00,… #> $ CatIdentifier        <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1… #> $ NoMeas               <int> 19, 42, 42, 42, 42, 5, 29, 29, 29, 5, 5, 5, 210, … #> $ SubFactor            <dbl> 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1… #> $ SubWgt               <int> 2500, NA, NA, NA, NA, NA, 1600, 1600, 1600, NA, N… #> $ CatCatchWgt          <int> 2500, 20200, 20200, 20200, 20200, 2700, 1600, 160… #> $ LngtCode             <chr> \".\", \"0\", \"0\", \"0\", \"0\", \"1\", \".\", \".\", \".\", \"1\",… #> $ LngtClass            <int> 260, 145, 145, 150, 150, 23, 200, 210, 220, 27, 2… #> $ HLNoAtLngt           <dbl> 1.00, 112.22, 112.22, 74.81, 74.81, 2.00, 2.00, 1… #> $ DevStage             <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… #> $ LenMeasType          <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… #> $ ValidAphiaID         <chr> \"127143\", \"126425\", \"126425\", \"126425\", \"126425\",… #> $ ScientificName_WoRMS <chr> \"Pleuronectes platessa\", \"Sprattus sprattus\", \"Sp… #> $ DateofCalculation    <chr> \"20180507\", \"20161115\", \"20161115\", \"20161115\", \"… #> $ .datatype            <chr> \"R\", \"C\", \"C\", \"C\", \"C\", \"C\", \"R\", \"R\", \"R\", \"C\",… #> $ .effort              <int> 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 3… #> $ n                    <dbl> 1.000, 56.110, 56.110, 37.405, 37.405, 1.000, 2.0… #> $ cpue                 <dbl> 2.00, 112.22, 112.22, 74.81, 74.81, 2.00, 4.00, 2… #> $ length               <dbl> 26, 14, 14, 15, 15, 23, 20, 21, 22, 27, 29, 30, 2…"},{"path":"https://einarhjorleifsson.github.io/obus/index.html","id":"a-little-exploration","dir":"","previous_headings":"","what":"A little exploration","title":"Implementing More and Better Use of ICES Survey data","text":"","code":"library(santoku) #>  #> Attaching package: 'santoku' #> The following object is masked from 'package:tidyr': #>  #>     chop # Grid resolution dx <- 1 dy <- dx / 2 # Limit analysis to certain time and space hh |>    filter(Year %in% 2001:2010,          between(ShootLong, -20, 25),          between(ShootLat, -Inf, 65)) |>    # assign coordinates to grid   mutate(lon = ShootLong%/%dx * dx + dx/2,          lat = ShootLat%/%dy * dy + dy/2) |>    left_join(hl |>                select(.id, ScientificName_WoRMS),            by = join_by(.id)) |>   # analyse by grid   group_by(lon, lat) |>    summarise(n_taxa = n_distinct(ScientificName_WoRMS),             .groups = \"drop\") |>    # load data into R memory because santoku::chop not in duckdb lingo   #  chop is also nicer than cut - keeps things more orderly   collect() |>    mutate(n_taxa = chop(n_taxa, breaks = c(0, 25, 50, 75, 100, 125, 150, 200))) |>    ggplot(aes(lon, lat, fill = n_taxa)) +   geom_tile() +   scale_fill_viridis_d(option = \"inferno\", direction = -1) +   coord_quickmap() +   labs(x = NULL, y = NULL, fill = \"Number of\\ndistinct taxa\",        caption = \"DATRAS 2001-2010, core area: Number of distinct taxa reported per rectangle\")"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_date.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate date based on Year, Month, and Day. — .dr_calc_date","title":"Calculate date based on Year, Month, and Day. — .dr_calc_date","text":"function adds new column date input table (DuckDB table dataframe), computed Year, Month, Day columns. provided input neither DuckDB table dataframe, function returns NULL informs user.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_date.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate date based on Year, Month, and Day. — .dr_calc_date","text":"","code":".dr_calc_date(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_date.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate date based on Year, Month, and Day. — .dr_calc_date","text":"d DuckDB connection table dataframe containing least columns: Year (numeric integer), Month (numeric integer), Day (numeric integer).","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_date.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate date based on Year, Month, and Day. — .dr_calc_date","text":"input table (DuckDB table dataframe) additional date column, NULL input neither DuckDB table dataframe.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_date.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate date based on Year, Month, and Day. — .dr_calc_date","text":"function checks required columns Year, Month, Day exist, throws error missing.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","title":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","text":"function calculates precise timestamp using Year, Month, Day, TimeShot columns input table (DuckDB table dataframe). TimeShot column expected numeric character string representing time 24-hour HHMM format. ensures required columns present input adjusts behavior based whether input DuckDB table standard dataframe.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","text":"","code":".dr_calc_time(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","text":"d DuckDB connection table dataframe containing least columns: Year (numeric integer), Month (numeric integer), Day (numeric integer), TimeShot (numeric character HHMM format).","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","text":"input table (DuckDB table dataframe) additional timestamp column, calculated POSIXct timestamp, NULL input neither DuckDB table dataframe.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_time.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","text":"function performs following: Pads TimeShot ensure 4 digits (e.g., 800 becomes 0800). Extracts hours minutes padded TimeShot. Combines values Year, Month, Day, Hour, Minute generate complete timestamp. Adds timestamp column (calculated) removes intermediate columns used processing.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_length_cm.html","id":null,"dir":"Reference","previous_headings":"","what":"Standardize length to cm — .dr_length_cm","title":"Standardize length to cm — .dr_length_cm","text":"Function adds new column length input dataframe, computed based LngtCode LngtClass values.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_length_cm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Standardize length to cm — .dr_length_cm","text":"","code":".dr_length_cm(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_length_cm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Standardize length to cm — .dr_length_cm","text":"d dataframe containing least two columns: LngtCode (character) LngtClass (numeric).","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_length_cm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Standardize length to cm — .dr_length_cm","text":"input table additional column length.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_length_cm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Standardize length to cm — .dr_length_cm","text":"transformation rules length column follows: LngtCode == \"-9\": length set NA (assumed handled upstream). LngtCode %% c(\".\", \"0\"): length computed floor LngtClass divided 10. LngtCode %% c(\"1\", \"2\", \"5\"): length directly set LngtClass. Otherwise: length set NA.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_n_and_cpue.html","id":null,"dir":"Reference","previous_headings":"","what":"Numbers caught and the CPUE in each length class — .dr_n_and_cpue","title":"Numbers caught and the CPUE in each length class — .dr_n_and_cpue","text":"function generates two new column n (numbers caught) cpue (numbers caught per one hour towing) length table (HL).","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_n_and_cpue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Numbers caught and the CPUE in each length class — .dr_n_and_cpue","text":"","code":".dr_n_and_cpue(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_n_and_cpue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Numbers caught and the CPUE in each length class — .dr_n_and_cpue","text":"d DATRAS length table (HL) containing columns .id, HLNoAtLngt, .datatype, .effort.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_n_and_cpue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Numbers caught and the CPUE in each length class — .dr_n_and_cpue","text":"input table additional columns n cpue.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coastline.html","id":null,"dir":"Reference","previous_headings":"","what":"Coastline covering majority of DATRAS data — dr_coastline","title":"Coastline covering majority of DATRAS data — dr_coastline","text":"Simple shapefile","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coastline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coastline covering majority of DATRAS data — dr_coastline","text":"","code":"dr_coastline"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coastline.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Coastline covering majority of DATRAS data — dr_coastline","text":"object class sf (inherits data.frame) 102 rows 1 columns.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coastline.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Coastline covering majority of DATRAS data — dr_coastline","text":"R-package rnaturalearth","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coltypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Datras variable types — dr_coltypes","title":"Datras variable types — dr_coltypes","text":"table containing variable (field) types datras data","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coltypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Datras variable types — dr_coltypes","text":"","code":"dr_coltypes"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coltypes.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Datras variable types — dr_coltypes","text":"object class tbl_df (inherits tbl, data.frame) 159 rows 3 columns.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coltypes.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Datras variable types — dr_coltypes","text":"https://www.ices.dk/data/Documents/DATRAS/DATRAS_Field_descriptions_and_example_file_May2022.xlsx","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coltypes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Datras variable types — dr_coltypes","text":"data frame 125 rows 3 columns: field DATRAS variable name returned icesDatras::getDATRAS type value type record DATRAS data type - \"HH\": haul data, \"HL\": length-based data, \"CA\": age-based data","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a DuckDB connection to a DATRAS Exchange dataset with Latin names included — dr_con","title":"Create a DuckDB connection to a DATRAS Exchange dataset with Latin names included — dr_con","text":"function establishes DuckDB connection DATRAS dataset based specified type (\"HH\", \"HL\" \"CA\"). dataset accessed via URL opened using duckdbfs::open_dataset function. function operates experimental tables include Latin names \"HL\" \"CA\" files.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a DuckDB connection to a DATRAS Exchange dataset with Latin names included — dr_con","text":"","code":"dr_con(   type = NULL,   trim = TRUE,   url = \"https://heima.hafro.is/~einarhj/datras_latin/\" )"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a DuckDB connection to a DATRAS Exchange dataset with Latin names included — dr_con","text":"type character string specifying type dataset. Must \"HH\", \"HL\", \"CA\". parameter maps specific files provided data source. trim boolean flag (default TRUE). TRUE type \"HL\" \"CA\", dataset trimmed ignore station-level fields. url http path DATRAS parquet files","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a DuckDB connection to a DATRAS Exchange dataset with Latin names included — dr_con","text":"DuckDB dataset object.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":"datapath-explanation","dir":"Reference","previous_headings":"","what":"Datapath Explanation","title":"Create a DuckDB connection to a DATRAS Exchange dataset with Latin names included — dr_con","text":"function constructs URL dataset based following pattern: \"https://heima.hafro./~einarhj/datras_latin/type.parquet\". type parameter determines specific file connect , : \"HH\" refers haul-level data. \"HL\" refers catch--length data. \"CA\" refers age-based biological sampling data. Optionally, \"HL\" \"CA\" types, setting trim = TRUE (default) excludes station-level variables. allows narrower view (read: fewer variables) observations, station-level variables can retrieved join haul table (HH) using .id column.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a DuckDB connection to a DATRAS Exchange dataset with Latin names included — dr_con","text":"","code":"if (FALSE) { # \\dontrun{   dr_con(\"HH\")              # Connect to haul-level data.   dr_con(\"HL\", trim=FALSE)  # Get all fields for catch-at-length data. } # }"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"function establishes DuckDB connection DATRAS exchange-format data based specified type. dataset accessed via URL opened using duckdbfs::open_dataset function.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"","code":"dr_con_exchange(type = NULL, url = \"https://heima.hafro.is/~einarhj/datras/\")"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"type character string specifying type dataset. Must \"HH\", \"HL\", \"CA\". parameter maps specific file types stored DATRAS data source. url http path DATRAS parquet files","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"DuckDB dataset object representing combined data specified type.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":"datapath-explanation","dir":"Reference","previous_headings":"","what":"Datapath Explanation","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"function constructs URL dataset : \"https://heima.hafro./~einarhj/datras/RecordType=type/Year=year/part-0.parquet\". type parameter determines file category (e.g., \"HH\", \"HL\", \"CA\"). function dynamically generates URLs years 1965 2025. DATRAS exchange dataset includes following: \"HH\" refers haul-level data. \"HL\" refers catch--length data. \"CA\" refers age-based biological sampling data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"","code":"if (FALSE) { # \\dontrun{   dr_con_exchange(\"HH\")  # Connect to haul-level data for all years.   dr_con_exchange(\"CA\")  # Connect to age-based biological data for all years. } # }"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Download DATRAS tables — dr_download_data","title":"Download DATRAS tables — dr_download_data","text":"DATRAS table (HH, HL, CA FL) downloaded saved.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download DATRAS tables — dr_download_data","text":"","code":"dr_download_data(   surveys = NULL,   years = NULL,   quarters = NULL,   outpath = \"data\",   filetype = \"parquet\" )"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download DATRAS tables — dr_download_data","text":"surveys Survey get, none specified get years Years download, none specified get 1990 onwards. yet active. quarters Quarters download, none specified get 1990 onwards. yet active. outpath path (default 'data') saved DATRAS exchange files stored filetype File type (default 'parquet'). Currently inactive. '","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download DATRAS tables — dr_download_data","text":"Files disk","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data_latin.html","id":null,"dir":"Reference","previous_headings":"","what":"Download DATRAS latin tables — dr_download_data_latin","title":"Download DATRAS latin tables — dr_download_data_latin","text":"DATRAS latin table (HH, HL, CA) downloaded saved.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data_latin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download DATRAS latin tables — dr_download_data_latin","text":"","code":"dr_download_data_latin(   surveys = NULL,   years = NULL,   quarters = NULL,   outpath = \"data\",   filetype = \"parquet\" )"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data_latin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download DATRAS latin tables — dr_download_data_latin","text":"surveys Survey get, none specified get years Years download, none specified attempt download quarters Quarters download, none specified attempt download outpath path (default 'data') saved DATRAS exchange files stored filetype File type (default 'parquet'). Currently inactive. '","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data_latin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download DATRAS latin tables — dr_download_data_latin","text":"Files disk","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve DATRAS Age (CA) Table — dr_getCA","title":"Retrieve DATRAS Age (CA) Table — dr_getCA","text":"Retrieve DATRAS age (CA) data given survey, year(s), quarter(s). function wrapper around icesDatras::getDATRAS(record = \"CA\", ...) ensures variable types properly set.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve DATRAS Age (CA) Table — dr_getCA","text":"","code":"dr_getCA(survey, years, quarters, quiet = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve DATRAS Age (CA) Table — dr_getCA","text":"survey character string, survey acronym (e.g., \"NS-IBTS\"). years integer vector years (e.g., 2010 2005:2010). quarters integer vector quarters (1, 2, 3, 4). quiet Logical; TRUE (default), suppress messages.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve DATRAS Age (CA) Table — dr_getCA","text":"tibble station data empty tibble data available.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getFL.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve DATRAS Flex (FL) Table — dr_getFL","title":"Retrieve DATRAS Flex (FL) Table — dr_getFL","text":"Retrieve DATRAS flex (FL) data given survey, year(s), quarter(s). function wrapper around icesDatras::getDATRAS(record = \"FL\", ...) ensures variable types properly set.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getFL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve DATRAS Flex (FL) Table — dr_getFL","text":"","code":"dr_getFL(surveys, years, quarters, quiet = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getFL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve DATRAS Flex (FL) Table — dr_getFL","text":"surveys character string, survey acronym (e.g., \"NS-IBTS\"). years integer vector years (e.g., 2010 2005:2010). quarters integer vector quarters (1, 2, 3, 4). quiet Logical; TRUE (default), suppress messages.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getFL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve DATRAS Flex (FL) Table — dr_getFL","text":"tibble station data empty tibble data available.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHH.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve DATRAS Station (HH) Table — dr_getHH","title":"Retrieve DATRAS Station (HH) Table — dr_getHH","text":"Retrieve DATRAS station (HH) data given survey, year(s), quarter(s). function wrapper around icesDatras::getDATRAS(record = \"HH\", ...) ensures variable types properly set.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHH.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve DATRAS Station (HH) Table — dr_getHH","text":"","code":"dr_getHH(survey, years, quarters, quiet = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHH.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve DATRAS Station (HH) Table — dr_getHH","text":"survey character string, survey acronym (e.g., \"NS-IBTS\"). years integer vector years (e.g., 2010 2005:2010). quarters integer vector quarters (1, 2, 3, 4). quiet Logical; TRUE (default), suppress messages.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHH.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve DATRAS Station (HH) Table — dr_getHH","text":"tibble station data empty tibble data available.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHL.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve DATRAS Length (HL) Table — dr_getHL","title":"Retrieve DATRAS Length (HL) Table — dr_getHL","text":"Retrieve DATRAS length (HL) data given survey, year(s), quarter(s). function wrapper around icesDatras::getDATRAS(record = \"HL\", ...) ensures variable types properly set.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve DATRAS Length (HL) Table — dr_getHL","text":"","code":"dr_getHL(survey, years, quarters, quiet = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve DATRAS Length (HL) Table — dr_getHL","text":"survey character string, survey acronym (e.g., \"NS-IBTS\"). years integer vector years (e.g., 2010 2005:2010). quarters integer vector quarters (1, 2, 3, 4). quiet Logical; TRUE (default), suppress messages.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve DATRAS Length (HL) Table — dr_getHL","text":"tibble station data empty tibble data available.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_get_data_latin.html","id":null,"dir":"Reference","previous_headings":"","what":"Get DATRAS tables with latin names — dr_get_data_latin","title":"Get DATRAS tables with latin names — dr_get_data_latin","text":"Get DATRAS tables latin names","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_get_data_latin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get DATRAS tables with latin names — dr_get_data_latin","text":"","code":"dr_get_data_latin(recordtype, survey, year, quarter, quiet = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_get_data_latin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get DATRAS tables with latin names — dr_get_data_latin","text":"recordtype HH, HL, CA survey Name survey, e.g. \"ROCKALL\" year text string, like \"1999:2009\" quarter text string, like \"1:4\" quiet boolean (default TRUE) - suppress messages '","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_get_data_latin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get DATRAS tables with latin names — dr_get_data_latin","text":"tibble","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_settypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Set variable types — dr_settypes","title":"Set variable types — dr_settypes","text":"Used downloading raw data ensures consistency column types","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_settypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set variable types — dr_settypes","text":"","code":"dr_settypes(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_settypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set variable types — dr_settypes","text":"d DATRAS exchange table","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_settypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set variable types — dr_settypes","text":"table dimention input","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_settypes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set variable types — dr_settypes","text":"column type setting according DATRAS_Field_descriptions_and_example_file_May2022.xlsx additional guesswork flexfile variables","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidy.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy DATRAS data — dr_tidy","title":"Tidy DATRAS data — dr_tidy","text":"Cleans formats DATRAS data table dispatching table-specific tidying functions. station tables (HH), optionally returns valid hauls (haulval == \"V\").","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy DATRAS data — dr_tidy","text":"","code":"dr_tidy(d, valid_hauls = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy DATRAS data — dr_tidy","text":"d duckdb-table connection tibble containing DATRAS data. valid_hauls Logical; TRUE (default), records haulval == \"V\" retained station tables (HH).","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy DATRAS data — dr_tidy","text":"duckdb-table connection tibble tidied DATRAS data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyca.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy DATRAS age (CA) data — dr_tidyca","title":"Tidy DATRAS age (CA) data — dr_tidyca","text":"Cleans formats age (CA) data, converting length units, setting weights, finalizing aphia codes.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy DATRAS age (CA) data — dr_tidyca","text":"","code":"dr_tidyca(d, trim = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy DATRAS age (CA) data — dr_tidyca","text":"d duckdb-table connection tibble containing CA data. trim Boolean (default TRUE) remove haul data","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy DATRAS age (CA) data — dr_tidyca","text":"duckdb-table connection tibble tidied CA data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyfl.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy DATRAS flex (FL) data — dr_tidyfl","title":"Tidy DATRAS flex (FL) data — dr_tidyfl","text":"Returns flex (FL) data unchanged. Placeholder future flex table tidying logic.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyfl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy DATRAS flex (FL) data — dr_tidyfl","text":"","code":"dr_tidyfl(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyfl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy DATRAS flex (FL) data — dr_tidyfl","text":"d duckdb-table connection tibble containing FL data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyfl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy DATRAS flex (FL) data — dr_tidyfl","text":"duckdb-table connection tibble (unchanged) FL data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhh.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy DATRAS station (HH) data — dr_tidyhh","title":"Tidy DATRAS station (HH) data — dr_tidyhh","text":"Filters formats station (HH) data, optionally retaining valid hauls (haulval == \"V\").","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy DATRAS station (HH) data — dr_tidyhh","text":"","code":"dr_tidyhh(d, valid_hauls = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy DATRAS station (HH) data — dr_tidyhh","text":"d duckdb-table connection tibble containing HH data. valid_hauls Logical; TRUE (default), valid hauls retained.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhh.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy DATRAS station (HH) data — dr_tidyhh","text":"duckdb-table connection tibble tidied HH data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhl.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy DATRAS length (HL) data — dr_tidyhl","title":"Tidy DATRAS length (HL) data — dr_tidyhl","text":"Cleans formats length (HL) data, removing records missing length class numbers, converting length units, applying subfactors, finalizing aphia codes.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy DATRAS length (HL) data — dr_tidyhl","text":"","code":"dr_tidyhl(d, trim = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy DATRAS length (HL) data — dr_tidyhl","text":"d duckdb-table connection tibble containing HL data. trim Boolean (default TRUE) remove haul data","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy DATRAS length (HL) data — dr_tidyhl","text":"duckdb-table connection tibble tidied HL data.","code":""}]
