[{"path":"https://einarhjorleifsson.github.io/obus/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Einar Hjorleifsson. Maintainer. Martin Pastoors. Author.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pastoors M (2025). obus: Implementing Better Use ICES Survey data. R package version 2025.12.24, https://einarhjorleifsson.github.io/obus/.","code":"@Manual{,   title = {obus: Implementing More and Better Use of ICES Survey data},   author = {Martin Pastoors},   year = {2025},   note = {R package version 2025.12.24},   url = {https://einarhjorleifsson.github.io/obus/}, }"},{"path":"https://einarhjorleifsson.github.io/obus/index.html","id":"obus","dir":"","previous_headings":"","what":"Implementing More and Better Use of ICES Survey data","title":"Implementing More and Better Use of ICES Survey data","text":"{obus} temporary experimental package used explore various DATRAS data connections wrapper functions make life little easier everyday user. may taken offical package.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Implementing More and Better Use of ICES Survey data","text":"can install development version imbus GitHub :","code":"# install.packages(\"pak\") #pak::pak(\"einarhjorleifsson/obus\")"},{"path":"https://einarhjorleifsson.github.io/obus/index.html","id":"table-connections","dir":"","previous_headings":"","what":"Table connections","title":"Implementing More and Better Use of ICES Survey data","text":"","code":"library(obus) hh <- dr_con(\"HH\") hl <- dr_con(\"HL\") ca <- dr_con(\"CA\")"},{"path":"https://einarhjorleifsson.github.io/obus/index.html","id":"a-little-peek","dir":"","previous_headings":"","what":"A little peek","title":"Implementing More and Better Use of ICES Survey data","text":"","code":"library(tidyverse) hl |> glimpse() #> Rows: ?? #> Columns: 19 #> Database: DuckDB 1.4.3 [unknown@Linux 5.10.0-33-amd64:R 4.4.1/:memory:] #> $ .id                  <chr> \"BITS:2017:1:DE:06SL:TVS:24001:1\", \"BITS:2003:4:D… #> $ SpecCodeType         <chr> \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\",… #> $ SpecCode             <chr> \"126417\", \"126417\", \"126417\", \"126417\", \"126417\",… #> $ SpecVal              <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\",… #> $ Sex                  <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… #> $ TotalNo              <dbl> 149.0, 158.0, 149.0, 158.0, 149.0, 221.0, 221.0, … #> $ CatIdentifier        <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1… #> $ NoMeas               <int> 149, 158, 149, 158, 149, 221, 221, 221, 221, 221,… #> $ SubFactor            <dbl> 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, … #> $ SubWgt               <int> NA, NA, NA, NA, NA, 43140, 43140, 43140, 43140, 4… #> $ CatCatchWgt          <int> 4458, 4700, 4458, 4700, 4458, 43140, 43140, 43140… #> $ LngtCode             <chr> \"0\", \"0\", \"0\", \"0\", \"0\", \".\", \".\", \".\", \".\", \".\",… #> $ LngtClass            <int> 145, 165, 150, 170, 155, 310, 320, 330, 220, 230,… #> $ HLNoAtLngt           <dbl> 5, 4, 12, 13, 9, 1, 2, 5, 24, 24, 17, 18, 14, 10,… #> $ DevStage             <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… #> $ LenMeasType          <chr> \"1\", NA, \"1\", NA, \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"… #> $ ValidAphiaID         <chr> \"126417\", \"126417\", \"126417\", \"126417\", \"126417\",… #> $ ScientificName_WoRMS <chr> \"Clupea harengus\", \"Clupea harengus\", \"Clupea har… #> $ DateofCalculation    <chr> \"20240814\", \"20250401\", \"20240814\", \"20250401\", \"…"},{"path":"https://einarhjorleifsson.github.io/obus/index.html","id":"a-little-exploration","dir":"","previous_headings":"","what":"A little exploration","title":"Implementing More and Better Use of ICES Survey data","text":"","code":"library(santoku) #>  #> Attaching package: 'santoku' #> The following object is masked from 'package:tidyr': #>  #>     chop # Grid resolution dx <- 1 dy <- dx / 2 # Limit analysis to certain time and space hh |>    filter(Year %in% 2001:2010,          between(ShootLong, -20, 25),          between(ShootLat, -Inf, 65)) |>    # assign coordinates to grid   mutate(lon = ShootLong%/%dx * dx + dx/2,          lat = ShootLat%/%dy * dy + dy/2) |>    left_join(hl |>                select(.id, ScientificName_WoRMS),            by = join_by(.id)) |>   # analyse by grid   group_by(lon, lat) |>    summarise(n_taxa = n_distinct(ScientificName_WoRMS),             .groups = \"drop\") |>    # load data into R memory because santoku::chop not in duckdb lingo   #  chop is also nicer than cut - keeps things more orderly   collect() |>    mutate(n_taxa = chop(n_taxa, breaks = c(0, 25, 50, 75, 100, 125, 150, 200))) |>    ggplot(aes(lon, lat, fill = n_taxa)) +   geom_tile() +   scale_fill_viridis_d(option = \"inferno\", direction = -1) +   coord_quickmap() +   labs(x = NULL, y = NULL, fill = \"Number of\\ndistinct taxa\",        caption = \"DATRAS 2001-2010, core area: Number of distinct taxa reported per rectangle\")"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_date.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate date based on Year, Month, and Day. — .dr_calc_date","title":"Calculate date based on Year, Month, and Day. — .dr_calc_date","text":"function adds new column date input table (DuckDB table dataframe), computed Year, Month, Day columns. provided input neither DuckDB table dataframe, function returns NULL informs user.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_date.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate date based on Year, Month, and Day. — .dr_calc_date","text":"","code":".dr_calc_date(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_date.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate date based on Year, Month, and Day. — .dr_calc_date","text":"d DuckDB connection table dataframe containing least columns: Year (numeric integer), Month (numeric integer), Day (numeric integer).","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_date.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate date based on Year, Month, and Day. — .dr_calc_date","text":"input table (DuckDB table dataframe) additional date column, NULL input neither DuckDB table dataframe.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_date.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate date based on Year, Month, and Day. — .dr_calc_date","text":"function checks required columns Year, Month, Day exist, throws error missing.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_length2cm.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate length based on LngtCode and LngtClass. — .dr_calc_length2cm","title":"Calculate length based on LngtCode and LngtClass. — .dr_calc_length2cm","text":"function adds new column length input dataframe, computed based LngtCode LngtClass values. transformation rules length column follows: LngtCode == \"-9\": length set NA (assumed handled upstream). LngtCode %% c(\".\", \"0\"): length computed floor LngtClass divided 10. LngtCode %% c(\"1\", \"2\", \"5\"): length directly set LngtClass. Otherwise: length set NA.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_length2cm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate length based on LngtCode and LngtClass. — .dr_calc_length2cm","text":"","code":".dr_calc_length2cm(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_length2cm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate length based on LngtCode and LngtClass. — .dr_calc_length2cm","text":"d dataframe containing least two columns: LngtCode (character) LngtClass (numeric).","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_length2cm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate length based on LngtCode and LngtClass. — .dr_calc_length2cm","text":"table d additional column length.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_n.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate column n based on DataType and HaulDur. — .dr_calc_n","title":"Calculate column n based on DataType and HaulDur. — .dr_calc_n","text":"function calculates new column n table (hl) joining another table (hh). calculation n depends values DataType column duration haul (HaulDur). function ensures required columns exist input tables processing.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_n.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate column n based on DataType and HaulDur. — .dr_calc_n","text":"","code":".dr_calc_n(hh, hl)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_n.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate column n based on DataType and HaulDur. — .dr_calc_n","text":"hh table containing columns .id, DataType, HaulDur. hl table containing columns .id HLNoAtLngt.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_n.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate column n based on DataType and HaulDur. — .dr_calc_n","text":"table created joining hh hl, additional column n: DataType == \"R\", n set HLNoAtLngt (data haul). DataType == \"C\", n calculated HLNoAtLngt * HaulDur / 60 (CPUE, number per hour). DataType == \"P\" \"S\", n set -9999 (unsupported case). DataType == \"-9\" .na(DataType), n set NA. DataType values default -10000 (unexpected).","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","title":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","text":"function calculates precise timestamp using Year, Month, Day, TimeShot columns input table (DuckDB table dataframe). TimeShot column expected numeric character string representing time 24-hour HHMM format. ensures required columns present input adjusts behavior based whether input DuckDB table standard dataframe.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","text":"","code":".dr_calc_time(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","text":"d DuckDB connection table dataframe containing least columns: Year (numeric integer), Month (numeric integer), Day (numeric integer), TimeShot (numeric character HHMM format).","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","text":"input table (DuckDB table dataframe) additional timestamp column, calculated POSIXct timestamp, NULL input neither DuckDB table dataframe.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dot-dr_calc_time.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate timestamp based on Year, Month, Day, and TimeShot. — .dr_calc_time","text":"function performs following: Pads TimeShot ensure 4 digits (e.g., 800 becomes 0800). Extracts hours minutes padded TimeShot. Combines values Year, Month, Day, Hour, Minute generate complete timestamp. Adds timestamp column (calculated) removes intermediate columns used processing.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coastline.html","id":null,"dir":"Reference","previous_headings":"","what":"Coastline covering majority of DATRAS data — dr_coastline","title":"Coastline covering majority of DATRAS data — dr_coastline","text":"Simple shapefile","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coastline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coastline covering majority of DATRAS data — dr_coastline","text":"","code":"dr_coastline"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coastline.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Coastline covering majority of DATRAS data — dr_coastline","text":"object class sf (inherits data.frame) 102 rows 1 columns.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coastline.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Coastline covering majority of DATRAS data — dr_coastline","text":"R-package rnaturalearth","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coltypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Datras variable types — dr_coltypes","title":"Datras variable types — dr_coltypes","text":"table containing variable (field) types datras data","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coltypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Datras variable types — dr_coltypes","text":"","code":"dr_coltypes"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coltypes.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Datras variable types — dr_coltypes","text":"object class tbl_df (inherits tbl, data.frame) 159 rows 3 columns.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coltypes.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Datras variable types — dr_coltypes","text":"https://www.ices.dk/data/Documents/DATRAS/DATRAS_Field_descriptions_and_example_file_May2022.xlsx","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_coltypes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Datras variable types — dr_coltypes","text":"data frame 125 rows 3 columns: field DATRAS variable name returned icesDatras::getDATRAS type value type record DATRAS data type - \"HH\": haul data, \"HL\": length-based data, \"CA\": age-based data","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a DuckDB connection to a DATRAS dataset (latin names included) — dr_con","title":"Create a DuckDB connection to a DATRAS dataset (latin names included) — dr_con","text":"function creates URL DATRAS dataset based input type opens dataset using duckdbfs::open_dataset function. type must one \"HH\", \"HL\", \"CA\".","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a DuckDB connection to a DATRAS dataset (latin names included) — dr_con","text":"","code":"dr_con(type = NULL, trim = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a DuckDB connection to a DATRAS dataset (latin names included) — dr_con","text":"type character string specifying type dataset. Must one \"HH\", \"HL\", \"CA\". trim boolean (default TRUE) removes station variables HL CA data, join made via \".id\" variable.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a DuckDB connection to a DATRAS dataset (latin names included) — dr_con","text":"DuckDB dataset object.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a DuckDB connection to a DATRAS dataset (latin names included) — dr_con","text":"connection experimental table setup includes latin name HL CA files","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a DuckDB connection to a DATRAS dataset (latin names included) — dr_con","text":"","code":"if (FALSE) { # \\dontrun{   dr_con(\"HH\") } # }"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"function creates URL DATRAS eschange dataset based input type opens dataset using duckdbfs::open_dataset function. type must one \"HH\", \"HL\", \"CA\".","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"","code":"dr_con_exchange(type = NULL)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"type character string specifying type dataset. Must one \"HH\", \"HL\", \"CA\".","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"DuckDB dataset object.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_con_exchange.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a DuckDB connection to a DATRAS dataset (exchange format) — dr_con_exchange","text":"","code":"if (FALSE) { # \\dontrun{   dr_con_exchange(\"HH\") } # }"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Download DATRAS tables — dr_download_data","title":"Download DATRAS tables — dr_download_data","text":"DATRAS table (HH, HL, CA FL) downloaded saved.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download DATRAS tables — dr_download_data","text":"","code":"dr_download_data(   surveys = NULL,   years = NULL,   quarters = NULL,   outpath = \"data\",   filetype = \"parquet\" )"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download DATRAS tables — dr_download_data","text":"surveys Survey get, none specified get years Years download, none specified get 1990 onwards. yet active. quarters Quarters download, none specified get 1990 onwards. yet active. outpath path (default 'data') saved DATRAS exchange files stored filetype File type (default 'parquet'). Currently inactive. '","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download DATRAS tables — dr_download_data","text":"Files disk","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data_latin.html","id":null,"dir":"Reference","previous_headings":"","what":"Download DATRAS latin tables — dr_download_data_latin","title":"Download DATRAS latin tables — dr_download_data_latin","text":"DATRAS latin table (HH, HL, CA) downloaded saved.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data_latin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download DATRAS latin tables — dr_download_data_latin","text":"","code":"dr_download_data_latin(   surveys = NULL,   years = NULL,   quarters = NULL,   outpath = \"data\",   filetype = \"parquet\" )"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data_latin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download DATRAS latin tables — dr_download_data_latin","text":"surveys Survey get, none specified get years Years download, none specified attempt download quarters Quarters download, none specified attempt download outpath path (default 'data') saved DATRAS exchange files stored filetype File type (default 'parquet'). Currently inactive. '","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_download_data_latin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download DATRAS latin tables — dr_download_data_latin","text":"Files disk","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve DATRAS Age (CA) Table — dr_getCA","title":"Retrieve DATRAS Age (CA) Table — dr_getCA","text":"Retrieve DATRAS age (CA) data given survey, year(s), quarter(s). function wrapper around icesDatras::getDATRAS(record = \"CA\", ...) ensures variable types properly set.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve DATRAS Age (CA) Table — dr_getCA","text":"","code":"dr_getCA(survey, years, quarters, quiet = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve DATRAS Age (CA) Table — dr_getCA","text":"survey character string, survey acronym (e.g., \"NS-IBTS\"). years integer vector years (e.g., 2010 2005:2010). quarters integer vector quarters (1, 2, 3, 4). quiet Logical; TRUE (default), suppress messages.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve DATRAS Age (CA) Table — dr_getCA","text":"tibble station data empty tibble data available.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getFL.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve DATRAS Flex (FL) Table — dr_getFL","title":"Retrieve DATRAS Flex (FL) Table — dr_getFL","text":"Retrieve DATRAS flex (FL) data given survey, year(s), quarter(s). function wrapper around icesDatras::getDATRAS(record = \"FL\", ...) ensures variable types properly set.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getFL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve DATRAS Flex (FL) Table — dr_getFL","text":"","code":"dr_getFL(surveys, years, quarters, quiet = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getFL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve DATRAS Flex (FL) Table — dr_getFL","text":"surveys character string, survey acronym (e.g., \"NS-IBTS\"). years integer vector years (e.g., 2010 2005:2010). quarters integer vector quarters (1, 2, 3, 4). quiet Logical; TRUE (default), suppress messages.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getFL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve DATRAS Flex (FL) Table — dr_getFL","text":"tibble station data empty tibble data available.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHH.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve DATRAS Station (HH) Table — dr_getHH","title":"Retrieve DATRAS Station (HH) Table — dr_getHH","text":"Retrieve DATRAS station (HH) data given survey, year(s), quarter(s). function wrapper around icesDatras::getDATRAS(record = \"HH\", ...) ensures variable types properly set.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHH.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve DATRAS Station (HH) Table — dr_getHH","text":"","code":"dr_getHH(survey, years, quarters, quiet = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHH.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve DATRAS Station (HH) Table — dr_getHH","text":"survey character string, survey acronym (e.g., \"NS-IBTS\"). years integer vector years (e.g., 2010 2005:2010). quarters integer vector quarters (1, 2, 3, 4). quiet Logical; TRUE (default), suppress messages.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHH.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve DATRAS Station (HH) Table — dr_getHH","text":"tibble station data empty tibble data available.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHL.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve DATRAS Length (HL) Table — dr_getHL","title":"Retrieve DATRAS Length (HL) Table — dr_getHL","text":"Retrieve DATRAS length (HL) data given survey, year(s), quarter(s). function wrapper around icesDatras::getDATRAS(record = \"HL\", ...) ensures variable types properly set.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve DATRAS Length (HL) Table — dr_getHL","text":"","code":"dr_getHL(survey, years, quarters, quiet = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve DATRAS Length (HL) Table — dr_getHL","text":"survey character string, survey acronym (e.g., \"NS-IBTS\"). years integer vector years (e.g., 2010 2005:2010). quarters integer vector quarters (1, 2, 3, 4). quiet Logical; TRUE (default), suppress messages.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getHL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve DATRAS Length (HL) Table — dr_getHL","text":"tibble station data empty tibble data available.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_get_data_latin.html","id":null,"dir":"Reference","previous_headings":"","what":"Get DATRAS tables with latin names — dr_get_data_latin","title":"Get DATRAS tables with latin names — dr_get_data_latin","text":"Get DATRAS tables latin names","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_get_data_latin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get DATRAS tables with latin names — dr_get_data_latin","text":"","code":"dr_get_data_latin(recordtype, survey, year, quarter, quiet = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_get_data_latin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get DATRAS tables with latin names — dr_get_data_latin","text":"recordtype HH, HL, CA survey Name survey, e.g. \"ROCKALL\" year text string, like \"1999:2009\" quarter text string, like \"1:4\" quiet boolean (default TRUE) - suppress messages '","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_get_data_latin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get DATRAS tables with latin names — dr_get_data_latin","text":"tibble","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getoverview.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize Data Availability — dr_getoverview","title":"Summarize Data Availability — dr_getoverview","text":"Retrieve table available DATRAS survey-year-quarter combinations. function wrapper around icesDatras::getDatrasDataOverview, returning tibble rather list matrices.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getoverview.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize Data Availability — dr_getoverview","text":"","code":"dr_getoverview(surveys = NULL)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getoverview.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize Data Availability — dr_getoverview","text":"surveys character vector survey names process, NULL process surveys.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_getoverview.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize Data Availability — dr_getoverview","text":"tibble columns survey, year, quarter available data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_settypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Set variable types — dr_settypes","title":"Set variable types — dr_settypes","text":"Used downloading raw data ensures consistency column types","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_settypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set variable types — dr_settypes","text":"","code":"dr_settypes(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_settypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set variable types — dr_settypes","text":"d DATRAS exchange table","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_settypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set variable types — dr_settypes","text":"table dimention input","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_settypes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set variable types — dr_settypes","text":"column type setting according DATRAS_Field_descriptions_and_example_file_May2022.xlsx additional guesswork flexfile variables","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidy.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy DATRAS data — dr_tidy","title":"Tidy DATRAS data — dr_tidy","text":"Cleans formats DATRAS data table dispatching table-specific tidying functions. station tables (HH), optionally returns valid hauls (haulval == \"V\").","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy DATRAS data — dr_tidy","text":"","code":"dr_tidy(d, valid_hauls = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy DATRAS data — dr_tidy","text":"d duckdb-table connection tibble containing DATRAS data. valid_hauls Logical; TRUE (default), records haulval == \"V\" retained station tables (HH).","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy DATRAS data — dr_tidy","text":"duckdb-table connection tibble tidied DATRAS data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyca.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy DATRAS age (CA) data — dr_tidyca","title":"Tidy DATRAS age (CA) data — dr_tidyca","text":"Cleans formats age (CA) data, converting length units, setting weights, finalizing aphia codes.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy DATRAS age (CA) data — dr_tidyca","text":"","code":"dr_tidyca(d, trim = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy DATRAS age (CA) data — dr_tidyca","text":"d duckdb-table connection tibble containing CA data. trim Boolean (default TRUE) remove haul data","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy DATRAS age (CA) data — dr_tidyca","text":"duckdb-table connection tibble tidied CA data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyfl.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy DATRAS flex (FL) data — dr_tidyfl","title":"Tidy DATRAS flex (FL) data — dr_tidyfl","text":"Returns flex (FL) data unchanged. Placeholder future flex table tidying logic.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyfl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy DATRAS flex (FL) data — dr_tidyfl","text":"","code":"dr_tidyfl(d)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyfl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy DATRAS flex (FL) data — dr_tidyfl","text":"d duckdb-table connection tibble containing FL data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyfl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy DATRAS flex (FL) data — dr_tidyfl","text":"duckdb-table connection tibble (unchanged) FL data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhh.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy DATRAS station (HH) data — dr_tidyhh","title":"Tidy DATRAS station (HH) data — dr_tidyhh","text":"Filters formats station (HH) data, optionally retaining valid hauls (haulval == \"V\").","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy DATRAS station (HH) data — dr_tidyhh","text":"","code":"dr_tidyhh(d, valid_hauls = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy DATRAS station (HH) data — dr_tidyhh","text":"d duckdb-table connection tibble containing HH data. valid_hauls Logical; TRUE (default), valid hauls retained.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhh.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy DATRAS station (HH) data — dr_tidyhh","text":"duckdb-table connection tibble tidied HH data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhl.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy DATRAS length (HL) data — dr_tidyhl","title":"Tidy DATRAS length (HL) data — dr_tidyhl","text":"Cleans formats length (HL) data, removing records missing length class numbers, converting length units, applying subfactors, finalizing aphia codes.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy DATRAS length (HL) data — dr_tidyhl","text":"","code":"dr_tidyhl(d, trim = TRUE)"},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy DATRAS length (HL) data — dr_tidyhl","text":"d duckdb-table connection tibble containing HL data. trim Boolean (default TRUE) remove haul data","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/dr_tidyhl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tidy DATRAS length (HL) data — dr_tidyhl","text":"duckdb-table connection tibble tidied HL data.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/get_datras_table_base.html","id":null,"dir":"Reference","previous_headings":"","what":"Download and read DATRAS data, single-year or contiguous year-range only — get_datras_table_base","title":"Download and read DATRAS data, single-year or contiguous year-range only — get_datras_table_base","text":"Accepts either single year (e.g. 1988) contiguous range years specified : single integer (e.g. 1988) single \"start:end\" style string (e.g. \"1988:2025\") numeric vector contiguous (e.g. 1988:2025)","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/get_datras_table_base.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download and read DATRAS data, single-year or contiguous year-range only — get_datras_table_base","text":"","code":"get_datras_table_base(   recordtype,   survey,   year,   quarter,   timeout = 300,   verbose = TRUE,   cache = TRUE,   cache_dir = NULL,   overwrite_cache = FALSE )"},{"path":"https://einarhjorleifsson.github.io/obus/reference/get_datras_table_base.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download and read DATRAS data, single-year or contiguous year-range only — get_datras_table_base","text":"recordtype character Record type (one \"HH\", \"HL\", \"CA\"; case-insensitive). survey character Survey short code (e.g. \"NS-IBTS\"). year integer|numeric|character Single year (e.g. 1988), contiguous range specified \"1988:2025\" 1988:2025. quarter integer|numeric|character Single quarter (1-4), contiguous range specified \"1:4\" 1:4. timeout numeric Timeout seconds downloads via options(timeout). Default 300. verbose logical Whether print progress messages. Default TRUE. cache logical Whether cache results disk. Default TRUE. cache_dir character Optional directory cache files. NULL default ~/.datras_cache (tempdir() HOME set). overwrite_cache logical TRUE, ignore existing cache file re-download (update cache). Default FALSE.","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/get_datras_table_base.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download and read DATRAS data, single-year or contiguous year-range only — get_datras_table_base","text":"data.frame","code":""},{"path":"https://einarhjorleifsson.github.io/obus/reference/get_datras_table_base.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Download and read DATRAS data, single-year or contiguous year-range only — get_datras_table_base","text":"Non-contiguous year lists (e.g. c(1988, 1990) c(\"1988\",\"1990\")) allowed produce error. Quarter accepts forms (single contiguous range), values must 1:4. recordtype argument must one \"HH\", \"HL\", \"CA\" (case-insensitive). version always performs single API request (using DATRAS range syntax ranges provided). function supports simple file-based caching across R sessions.","code":""}]
